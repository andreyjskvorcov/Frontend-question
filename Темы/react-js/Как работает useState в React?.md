
---

# Как работает useState в React?

**useState** — это хук в React, который позволяет добавлять состояние в функциональные компоненты. До появления хуков состояние было доступно только в классовых компонентах. С помощью useState состояние можно использовать в функциональных компонентах, что упрощает написание и поддержку кода.

---

## Основные принципы работы useState

- **Инициализация состояния**  
  Хук `useState` принимает начальное значение и возвращает массив из двух элементов:

  1. Текущее значение состояния.
  2. Функцию для обновления состояния.

- **Обновление состояния**  
  Когда состояние изменяется через вызов функции обновления, компонент перерисовывается с новым значением состояния.

---

## Пример использования useState

```JS <code>
import { useState } from "react";

function Counter() {
  const [count, setCount] = useState(0); // Инициализация состояния с начальным значением 0

  const increment = () => {
    setCount(count + 1); // Обновление состояния
  };

  return (
    <div>
      <p>Счётчик: {count}</p>
      <button onClick={increment}>Увеличить</button>
    </div>
  );
}
</code>
```

---

## Важные моменты при использовании useState

- Функция обновления состояния может принимать либо новое значение, либо функцию, которая получает предыдущее состояние и возвращает новое:

```JS <code>
setCount(prevCount => prevCount + 1);
```

- Такой способ обновления на основе предыдущего состояния помогает избежать проблем с асинхронностью обновлений.

---

## Пример с функцией для обновления состояния

```JS <code>
function Counter() {
  const [count, setCount] = useState(0);

  const increment = () => {
    setCount(prevCount => prevCount + 1); // Используем предыдущее состояние
  };

  return (
    <div>
      <p>Счётчик: {count}</p>
      <button onClick={increment}>Увеличить</button>
    </div>
  );
}
</code>
```

---

## Особенность: ленивое инициализирование состояния

Если передать в `useState` функцию, эта функция выполнится только один раз — при первом рендере компонента. Это удобно, если начальное состояние вычисляется тяжело.

```JS <code>
import { useState } from "react";

// Функция для сложных вычислений
function compute() {
  console.log("Вычисления выполняются...");
  return 42; // Например, результат сложных вычислений
}

function MyComponent() {
  const [count, setCount] = useState(() => compute()); // compute вызовется только один раз

  return (
    <div>
      <p>Значение: {count}</p>
    </div>
  );
}
</code>
```

---

## Итог

`useState` позволяет легко и эффективно работать с состоянием в функциональных компонентах React, делая интерфейсы динамичными и отзывчивыми.

---

Источник: [Как работает useState в React — hackfrontend](https://www.hackfrontend.com/docs/react/react-hooks-1)[1]

[1](https://www.hackfrontend.com/docs/react/react-batching)
