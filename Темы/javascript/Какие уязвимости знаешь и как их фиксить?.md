Веб-приложения подвержены множеству уязвимостей, которые могут привести к утечкам данных, повреждению системы или компрометации пользователей. Вот основные распространённые уязвимости и способы их предотвращения.

---

### Основные уязвимости и методы их исправления

| Уязвимость                            | Описание                                                              | Способы защиты                                                                                                  |
| ------------------------------------- | --------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| **XSS (Cross-Site Scripting)**        | Внедрение вредоносного скрипта на страницу.                           | Экранирование пользовательского ввода, Content Security Policy (CSP), безопасное использование React / Angular. |
| **SQL-инъекция**                      | Внедрение вредоносного SQL-кода в запросах к базе данных              | Использование параметризованных запросов (prepared statements), ORM, валидация и фильтрация вводимых данных.    |
| **CSRF (Cross-Site Request Forgery)** | Подделка запросов от имени пользователя без его ведома.               | Использование токенов CSRF, проверка Referer, SameSite cookie.                                                  |
| **Протоколы и сертификаты**           | Уязвимости из-за неиспользования HTTPS, устаревших версий протоколов. | Внедрение HTTPS с современными TLS, регулярное обновление сертификатов и протоколов.                            |
| **Утечки данных (Data Leakage)**      | Неправильная обработка личных данных, конфиденциальной информации.    | Шифрование данных, ограничения доступа, аудит и мониторинг.                                                     |
| **Неправильная аутентификация**       | Слабые пароли, небезопасное хранение учетных данных.                  | Использование многофакторной аутентификации, хеширование паролей (bcrypt), политика паролей.                    |
| **Неправильные права доступа**        | Несанкционированный доступ к ресурсам и данным.                       | Гранулярная система прав, проверка авторизации на сервере, разделение ролей.                                    |
| **Clickjacking**                      | Клик по скрытым элементам страницы                                    | Заголовок `X-Frame-Options`, Content Security Policy (CSP)                                                      |
| **Remote Code Execution (RCE)**       | Возможность выполнения произвольного кода                             | Валидация и проверка вводимых данных, ограничение прав процессов                                                |

---

### Пример защиты от XSS в React

```jsx
function SafeComponent({ userInput }) {
  return <div>{userInput}</div>; // React экранирует опасные символы автоматически
}
```

---

### Пример предотвращения SQL-инъекции

```js
const result = await db.query('SELECT * FROM users WHERE id = $1', [userId]);
```

---

### Итог

Защита веб-приложения требует комплексного подхода: правильной валидации и санитизации данных, использования современных протоколов и механизмов аутентификации, а также контроля прав доступа. Регулярное обновление и аудит кода и инфраструктуры помогает минимизировать риски уязвимостей.[1][2]

Ниже приведены примеры для каждой из основных уязвимостей и способы их защиты на практике.

---

### XSS (Cross-Site Scripting)

**Уязвимость:** Внедрение вредоносного JavaScript-кода, который выполняется в браузере жертвы.

**Пример атаки:**

```html
<div id="content"></div>
<script>
  const userInput = '<img src=x onerror=alert("XSS")>';
  document.getElementById('content').innerHTML = userInput; // Опасно: вставка как HTML
</script>
```

**Защита:**

```jsx
function SafeComponent({ userInput }) {
  return <div>{userInput}</div>; // React автоматически экранирует опасные символы
}
```

---

### SQL-инъекция

**Уязвимость:** Внедрение вредоносного SQL-кода через ввод пользователя.

**Опасный пример:**

```js
const userId = '1 OR 1=1'; // злоумышленник
const query = `SELECT * FROM users WHERE id = ${userId}`;
// Запрос становится: SELECT * FROM users WHERE id = 1 OR 1=1
```

**Защита:**

```js
const userId = req.params.id;
const result = await db.query('SELECT * FROM users WHERE id = $1', [userId]); // Параметризованный запрос
```

---

### CSRF (Cross-Site Request Forgery)

**Уязвимость:** Отправка запроса от имени пользователя без его ведома.

**Защита с использованием CSRF-токена:**

```js
// На сервере генерируем токен и вставляем в форму
<form method="POST" action="/submit">
  <input type="hidden" name="_csrf" value="{{csrfToken}}">
  ...
</form>
```

```js
// При обработке запроса проверяем валидность токена
app.post('/submit', csrfProtection, (req, res) => {
  // если токен невалидный, запрос отклоняется
});
```

---

### HTTPS и сертификаты

**Уязвимость:** Передача данных в открытом виде, подвержена перехвату.

**Защита:** Настройка SSL/TLS

```nginx
server {
  listen 443 ssl;
  ssl_certificate /path/cert.pem;
  ssl_certificate_key /path/key.pem;
  ...
}
```

---

### Утечки данных

**Уязвимость:** Доступ к конфиденциальным данным.

**Пример защиты:**

```js
const encryptedData = encrypt(data, secretKey);
// Хранение и передача только зашифрованных данных
```

---

### Аутентификация

**Уязвимость:** Слабые пароли, хранение в открытом виде.

**Защита с bcrypt:**

```js
const bcrypt = require('bcrypt');
const hash = await bcrypt.hash(password, 10); // Хеширование при регистрации
const match = await bcrypt.compare(inputPassword, hash); // Проверка пароля при входе
```

---

### Права доступа

**Уязвимость:** Несанкционированный доступ.

**Пример проверки прав на сервере:**

```js
app.get('/admin', (req, res) => {
  if (req.user.role !== 'admin') {
    return res.status(403).send('Доступ запрещён');
  }
  res.send('Панель администратора');
});
```

---

### Clickjacking

**Защита через заголовок HTTP**

```http
X-Frame-Options: DENY
```

---

### RCE (Remote Code Execution)

**Защита:** Валидация и ограничение ввода, изоляция процессов.

```js
// Не выполнять непроверенный код!
```

---

Эти практические примеры показывают, как исправлять и предотвращать основные уязвимости для безопасности веб-приложений.

[1](https://habr.com/ru/companies/itelma/articles/546372/)
[2](https://habr.com/ru/articles/925208/)
